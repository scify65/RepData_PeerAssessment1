---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
```{r setoptions,echo=TRUE}
require(knitr)
require(dplyr)
require(ggplot2)
opts_chunk$set(echo=TRUE)
```

## Loading and preprocessing the data
First, the data needs to be read into R using the read.csv function:
```{r readin}
data<-read.csv("activity.csv",colClasses=c("numeric","character","numeric"))
```

Then, the date variable needs to be converted from a character vector to a Date vector.
```{r convert}
data$date<-as.Date(data$date, "%Y-%m-%d")
```

## What is mean total number of steps taken per day?
To answer this question, the data needs to first be grouped on the date variable and then the average taken of the number of steps on each day.
```{r steps data}
steps<-data%>%group_by(date)%>%summarise(total_steps=sum(steps))
```
Then a histogram needs to be built, in this case with the ggplot2 system.
```{r stepsplot}
steps.plot<-ggplot(steps,aes(total_steps))+geom_histogram()+
    labs(main="Total Steps per Day")+scale_y_continuous(breaks=seq(0,10,2))+
    xlab("Daily Step Totals")+ylab("Count")
print(steps.plot)
```
Finally, we'll use the data set we created above to check the overall mean and standard deviation for the number of steps taken.
```{r stepsavs}
head(summarize(steps,mean=mean(total_steps),sd=sd(total_steps)))
```

## What is the average daily activity pattern?
activity<-data%>%group_by(interval)%>%
    summarize(average_steps=mean(steps,na.rm=TRUE))
activ.plot<-ggplot(activity,aes(interval,average_steps))+geom_line()+
    labs(main="Average Steps per Time Interval")+xlab("Interval")+
    ylab("Step Average")

filter(activity,average_steps==max(average_steps))


## Imputing missing values
ok<-complete.cases(data)
sum(!ok)
missing<-mutate(data, steps = replace(data$steps, is.na(data$steps), 
                                         activity$average_steps))
miss<-missing%>%group_by(date)%>%summarise(total_steps=sum(steps))
miss.plot<-ggplot(miss,aes(total_steps))+geom_histogram()+
    labs(main="Total Steps per Day")+scale_y_continuous(breaks=seq(0,10,2))+
    xlab("Daily Step Totals")+ylab("Count")
print(miss.plot)

head(summarize(miss,mean=mean(total_steps),sd=sd(total_steps)))


## Are there differences in activity patterns between weekdays and weekends?
weekend<-c("Saturday","Sunday")
data$weekday<-factor((weekdays(data$date) %in% weekend),levels=c("FALSE","TRUE"),
                     labels=c("Weekday","Weekend"))
day<-data%>%group_by(weekday,interval)%>%
    summarize(average_steps=mean(steps,na.rm=TRUE))
day.plot<-ggplot(day,aes(interval,average_steps))+geom_line()+
    labs(main="Average Steps per Time Interval")+xlab("Interval")+
    ylab("Step Average")+facet_grid(weekday~.)
print(day.plot)